(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{355:function(t,a,r){t.exports=r.p+"assets/img/sharedptrfunc.3982d8d5.jpg"},385:function(t,a,r){"use strict";r.r(a);var s=r(26),_=Object(s.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"raii与智能指针"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#raii与智能指针"}},[t._v("#")]),t._v(" RAII与智能指针")]),t._v(" "),s("h2",{attrs:{id:"raii"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#raii"}},[t._v("#")]),t._v(" RAII")]),t._v(" "),s("p",[t._v("资源获取即初始化（Resource Acquisition Is Initialization），利用"),s("strong",[t._v("栈")]),t._v("上的"),s("strong",[t._v("局部对象")]),t._v("离开作用域后，自动调用析构函数，管理资源（在析构函数中delete资源）")]),t._v(" "),s("ol",[s("li",[t._v("将每个资源封装进一个类\n"),s("ol",[s("li",[t._v("构造函数：请求资源，或在它无法完成时抛出异常")]),t._v(" "),s("li",[t._v("析构函数：释放资源，并绝不抛出异常")])])]),t._v(" "),s("li",[t._v("始终经由RAII类的实例使用资源\n"),s("ol",[s("li",[t._v("自身拥有自动存储期或临时生存期")]),t._v(" "),s("li",[t._v("具有自动或临时对象的生存期绑定的生存期")])])])]),t._v(" "),s("h2",{attrs:{id:"智能指针"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#智能指针"}},[t._v("#")]),t._v(" 智能指针")]),t._v(" "),s("p",[t._v("智能指针是一种RAII，利用引用计数，自动管理资源")]),t._v(" "),s("h3",{attrs:{id:"shared-ptr"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#shared-ptr"}},[t._v("#")]),t._v(" shared_ptr")]),t._v(" "),s("ol",[s("li",[t._v("强引用，引用计数为0时释放资源")]),t._v(" "),s("li",[t._v("成员函数\n"),s("img",{attrs:{src:r(355),alt:"shared_ptr function"}})])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("应使用 weak_ptr 避免循环引用")]),t._v(" "),s("li",[t._v("如果容器类型为shared_ptr,如vector<shared_ptr>，那么必须手动从vector中删除shared_ptr才能调用让计数枧减为0，应使用weak_ptr，这样当其他地方没有引用时，所指资源可以调用析构函数释放掉")]),t._v(" "),s("li",[t._v("boost::bind()会把参数copy一份，如果参数为share_ptr则对象生命期不会短于boost::fuction对象")])])]),t._v(" "),s("h3",{attrs:{id:"weak-ptr"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#weak-ptr"}},[t._v("#")]),t._v(" weak_ptr")]),t._v(" "),s("ol",[s("li",[t._v("弱引用，不增加引用计数")]),t._v(" "),s("li",[t._v("可以提升为shared_ptr")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("弱回调指，若对象存在调用对应的方法，否则什么也不做，通过尝试提升weak_ptr为shared_ptr可判断对象是否存在")])])]),t._v(" "),s("h3",{attrs:{id:"unique-ptr"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unique-ptr"}},[t._v("#")]),t._v(" unique_ptr")]),t._v(" "),s("ol",[s("li",[t._v("唯一")])])])}),[],!1,null,null,null);a.default=_.exports}}]);